Sub RunMacroMultipleTimes()
    Dim macroText As String
    Dim newUserID1 As String
    Dim newUserID2 As String
    Dim newUsername As String
    Dim newMirrorUser As String
    Dim newTodayDate As String
    Dim originalFilePath As String
    
    ' Set new values for placeholders
    newUserID1 = "NewUserID1"
    newUserID2 = "NewUserID2"
    newUsername = "Please insert User full name"
    newMirrorUser = "NewMirrorUser"
    newTodayDate = "NewTodayDate"
    
    ' Set the path for the original file
    originalFilePath = "C:\Users\ammohamed\AppData\Roaming\IBM\Client Access\Emulator\private\Create_new_user.mac"
    
    ' Read the macro text from the original file
    macroText = ReadMacroFromFile(originalFilePath)
    
    ' Replace placeholders with new values
    macroText = Replace(macroText, "USERID1", newUserID1)
    macroText = Replace(macroText, "USERID2", newUserID2)
    macroText = Replace(macroText, "USERNAME", newUsername)
    macroText = Replace(macroText, "MIRRORUSER", newMirrorUser)
    macroText = Replace(macroText, "TODAYDATE", newTodayDate)
    
    ' Run the modified macro
    RunMacro macroText
End Sub

Function ReadMacroFromFile(filePath As String) As String
    Dim fileNum As Integer
    Dim fileContent As String
    
    ' Open the file for reading
    fileNum = FreeFile
    Open filePath For Input As fileNum
    
    ' Read the contents of the file
    fileContent = Input$(LOF(fileNum), fileNum)
    
    ' Close the file
    Close fileNum
    
    ReadMacroFromFile = fileContent
End Function

Sub RunMacro(macroText As String)
    ' Paste your macro code here
    ' For example:
    ' Application.Run "YourMacroName"
    ' or execute the macro text directly
    ' Application.ExecuteExcel4Macro macroText
End Sub
