Sub EditMacroParametersAndSave()
    Dim macroText As String
    Dim newUserID As String
    Dim newUserID1 As String
    Dim newUserID2 As String
    Dim newUsername As String
    Dim newMirrorUser As String
    Dim newTodayDate As String
    Dim originalFilePath As String
    Dim newFilePath As String
    Dim modifiedMacroText As String
    
    ' Set the path for the original file
    originalFilePath = "C:\Users\ammohamed\AppData\Roaming\IBM\Client Access\Emulator\private\Create_new_user.mac"
    
    ' Read the macro text from the original file
    macroText = ReadMacroFromFile(originalFilePath)
    
    ' Prompt the user to enter new values for parameters
    newUserID = InputBox("Enter new value for USERID (4 characters):", "Edit Parameters")
    If Len(newUserID) <> 4 Then
        MsgBox "USERID must be 4 characters long. Please try again.", vbExclamation
        Exit Sub
    End If
    newUserID1 = Left(newUserID, 2)
    newUserID2 = Right(newUserID, 2)
    
    newUsername = InputBox("Enter new value for USERNAME:", "Edit Parameters")
    newMirrorUser = InputBox("Enter new value for MIRRORUSER:", "Edit Parameters")
    newTodayDate = InputBox("Enter new value for TODAYDATE:", "Edit Parameters")
    
    ' Replace placeholders with new values
    modifiedMacroText = Replace(macroText, "USERID1", newUserID1)
    modifiedMacroText = Replace(modifiedMacroText, "USERID2", newUserID2)
    modifiedMacroText = Replace(modifiedMacroText, "USERNAME", newUsername)
    modifiedMacroText = Replace(modifiedMacroText, "MIRRORUSER", newMirrorUser)
    modifiedMacroText = Replace(modifiedMacroText, "TODAYDATE", newTodayDate)
    
    ' Specify the path for the new file
    newFilePath = "C:\Users\ammohamed\AppData\Roaming\IBM\Client Access\Emulator\private\Modified_macro.mac"
    
    ' Save the modified macro text to the new file
    WriteMacroToFile modifiedMacroText, newFilePath
    
    MsgBox "Modified macro saved to: " & newFilePath
End Sub

Function ReadMacroFromFile(filePath As String) As String
    Dim fileNum As Integer
    Dim fileContent As String
    
    ' Open the file for reading
    fileNum = FreeFile
    Open filePath For Input As fileNum
    
    ' Read the contents of the file
    fileContent = Input$(LOF(fileNum), fileNum)
    
    ' Close the file
    Close fileNum
    
    ReadMacroFromFile = fileContent
End Function

ub WriteMacroToFile(ByVal macroText As String, ByVal filePath As String)
    Dim fileNum As Integer
    
    ' Open the file for writing
    fileNum = FreeFile
    Open filePath For Output As #fileNum
    
    ' Write the modified macro text to the file
    Print #fileNum, macroText
    
    ' Close the file
    Close #fileNum
End Sub
