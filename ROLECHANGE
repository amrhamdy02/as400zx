Sub ChangeUserIDAndRole()
    Dim newUserID As String
    Dim newRole As String
    Dim originalFilePath As String
    Dim newFileName As String
    Dim fileNumber As Integer
    Dim originalData As String
    Dim modifiedData As String
    Dim directoryPath As String
    
    ' Hardcoded path for the original file
    originalFilePath = "C:\Users\ammohamed\AppData\Roaming\IBM\Client Access\Emulator\private\Changerole.mac"
    
    ' Prompt the user to specify the new value for USERID
    newUserID = InputBox("Enter the new value for USERID:", "New USERID")
    
    ' Display the user form to select the role
    UserForm1.Show vbModeless
    
    ' Wait until the user form is closed
    Do While UserForm1.Visible
        DoEvents
    Loop
    
    ' Get the selected role from the user form
    newRole = UserForm1.cmbRole.Value
    
    ' Get the directory path of the original file
    directoryPath = Left(originalFilePath, InStrRev(originalFilePath, "\"))
    
    ' Create the new filename based on the inputted USERID
    newFileName = directoryPath & Replace(newUserID, " ", "_") & ".mac"
    
    ' Read the original data from the file
    Open originalFilePath For Input As #1
    originalData = Input$(LOF(1), #1)
    Close #1
    
    ' Perform string replacement for USERID and ROLE
    modifiedData = Replace(originalData, "USERID", newUserID) ' Replace USERID
    modifiedData = Replace(modifiedData, "ROLE", IIf(newRole = "Maker", "MK", "CH")) ' Replace ROLE with MK or CH based on the selected role
    
    ' Save the modified data to the new file
    fileNumber = FreeFile
    Open newFileName For Output As #fileNumber
    Print #fileNumber, modifiedData
    Close #fileNumber
    
    ' Inform the user
    MsgBox "Data replaced and saved to '" & newFileName & "'."
End Sub
